
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>월간 브랜드/유통사 평판 보고서</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Noto Sans KR', sans-serif; 
            margin: 0; 
            padding: 0; 
            background-color: #f0f2f5; 
            color: #333;
        }
        .container { 
            max-width: 1400px; 
            margin: 30px auto; 
            padding: 30px; 
            background-color: #fff; 
            border-radius: 12px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
        }
        h1 { 
            color: #2c3e50; 
            text-align: center; 
            padding-bottom: 20px; 
            border-bottom: 3px solid #f0f2f5; 
            margin-bottom: 40px; 
        }
        h2 { 
            color: #34495e; 
            border-left: 5px solid #3498db; 
            padding-left: 10px; 
            margin-bottom: 25px; 
        }
        h3 { 
            color: #555; 
            margin-top: 0; 
        }
        .section-box { 
            margin-bottom: 50px; 
            padding: 30px; 
            border: 1px solid #e1e8ed; 
            border-radius: 10px; 
            background-color: #fafbfd; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .chart-box { 
            width: 100%; 
            max-height: 400px;
            margin-bottom: 30px; 
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .table-box { 
            width: 100%; 
            margin-top: 20px; 
            overflow-x: auto;
        }
        table { 
            width: 100%; 
            border-collapse: collapse; 
            border-radius: 8px; 
            overflow: hidden;
            background-color: #fff;
        }
        th, td { 
            border: 1px solid #e1e8ed; 
            padding: 15px; 
            text-align: center; 
        }
        th { 
            background-color: #ecf0f1; 
            font-weight: 700; 
        }
        tr:nth-child(even) { background-color: #f9f9f9; }
        .flex-container { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 30px; 
            align-items: flex-start;
        }
        .half-width { 
            flex: 1 1 45%; 
            min-width: 300px;
        }
        .full-width { 
            flex: 1 1 100%; 
        }
        
        /* 새로운 색상 팔레트 */
        .color-positive { background-color: #67CA43; } /* 긍정 */
        .color-negative { background-color: #F57D6E; } /* 부정 */
        .color-neutral { background-color: #CAC4BC; } /* 중립 */

        /* 텍스트 색상 */
        .text-positive { color: #67CA43; font-weight: bold; }
        .text-negative { color: #F57D6E; font-weight: bold; }

        @media (max-width: 768px) {
            .flex-container { flex-direction: column; }
            .half-width { width: 100%; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>피씨디렉트 브랜드 평판 보고서 <span style="font-size: 50%;">(2025-10-10 ~ 2025-11-10)</span></h1>
        
        <div class="section-box">
            <h2>주간 주요현황</h2>
            <p>* 11월 1주차 주요 커뮤니티에 피씨디렉트 2건, 대원1건, 인텍 2건 게시글이 게시되었습니다.</p>
            <p>* <b>피씨디렉트 AS가 개선 되었다는 만족</b> 후기가 작성되었고, 댓글 17건도 자사 AS에 개선에 대한 공감 및 호평 내용으로 게시되었습니다..</p>
            <p>* <b>'요즘 피씨디렉트 as 잘받았다는 후기가 많더라구요.'</b> 등 당사 AS 품질 개선에 대한 내용들이 <b>2,400회 이상 조회</b>되었습니다.</p>
        </div>

        <div class="section-box">
            <h2>1. 평판 종합 현황</h2>
            <p></p>
            <p></p>
            <div class="flex-container">
                <div class="half-width">
                    <h3>유통사별 게시글 건수</h3>
                    <div class="chart-box">
                        <canvas id="brandCountsChart"></canvas>
                    </div>
                </div>
                <div class="half-width">
                    <h3>유형별 게시글 건수</h3>
                    <div class="table-box">
                        <table>
                            <thead>
                                <tr><th>유통사</th><th>전체</th><th>제품</th><th>서비스</th></tr>
                            </thead>
                            <tbody id="brandCountsTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
            <p></p>
            <p></p>
            <div class="flex-container">
                <div class="half-width">
                    <h3>게시글 평판 비율</h3>
                    <div class="chart-box" style="height: 300px; padding: 20px;">
                        <canvas id="overallSentimentChart"></canvas>
                    </div>
                </div>
                <div class="half-width">
                    <h3>유통사별 긍/부정 비율 상세</h3>
                    <div class="table-box">
                        <table>
                            <thead>
                                <tr><th>구분</th><th>긍정</th><th>부정</th><th>중립</th></tr>
                            </thead>
                            <tbody id="sentimentTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="section-box">
            <h2>2. 유형별 평판 분석</h2>
            <p></p>
            <div class="full-width">
                <h3>제품(브랜드 제조사)에 대한 평판</h3>
                <p></p>
                <div class="chart-box">
                    <canvas id="productSentimentChart"></canvas>
                </div>
                <h3>제품(브랜드 제조사) 평판 상세</h3>
                <div class="table-box">
                    <table>
                        <thead>
                            <tr><th>유통사(제조사 관련)</th><th>긍정</th><th>부정</th><th>중립</th></tr>
                        </thead>
                        <tbody id="productTableBody"></tbody>
                    </table>
                </div>
                <p></p>
            </div>
            <p></p>

            <div class="full-width">
                <h3>서비스(유통사) 평판 분석</h3>
                <p></p>
                <div class="chart-box">
                    <canvas id="serviceSentimentChart"></canvas>
                </div>
                <p></p>
                <p></p>
                <h3>서비스(유통사) 평판 상세</h3>
                <div class="table-box">
                    <table>
                        <thead>
                            <tr><th>유통사</th><th>긍정</th><th>부정</th><th>중립</th></tr>
                        </thead>
                        <tbody id="serviceTableBody"></tbody>
                    </table>
                </div>
                <p></p>
            </div>
            <p></p>
        </div>
        
        <div class="section-box">
        <p></p>
            <h2>3. 시계열 평판 추이 (주간 단위)</h2>
            <div class="full-width">
                <p></p>
                <h3>주차별 평판 변화 추이</h3>
                <p></p>
                <div class="chart-box">
                    <canvas id="weeklySentimentChart"></canvas>
                </div>
            </div>
            <div class="full-width">
                <h3>주차별 평판 상세 데이터</h3>
                <div class="table-box">
                    <table>
                        <thead>
                            <tr>
                                <th rowspan="2">주차</th>
                                <th colspan="3">피씨디렉트</th>
                                <th colspan="3">제이씨현</th>
                                <th colspan="3">대원</th>
                                <th colspan="3">인텍</th>
                                <th colspan="3">코잇</th>
                            </tr>
                            <tr>
                                <th>긍정</th><th>부정</th><th>중립</th>
                                <th>긍정</th><th>부정</th><th>중립</th>
                                <th>긍정</th><th>부정</th><th>중립</th>
                                <th>긍정</th><th>부정</th><th>중립</th>
                                <th>긍정</th><th>부정</th><th>중립</th>
                            </tr>
                        </thead>
                        <tbody id="weeklyTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="section-box">
            <h2>4. 브랜드별 최근 게시글 (5건)</h2>
            <div id="recentPostsSection" class="full-width"></div>
        </div>
        
        <p></p>
    </div>
    <p></p>

    <script>
        const reportData = {"brand_counts": {"피씨디렉트": 5, "제이씨현": 4, "대원": 8, "인텍": 4, "코잇": 2}, "brand_sentiment_ratios": {"피씨디렉트": {"긍정": 40.0, "부정": 0.0, "중립": 60.0}, "제이씨현": {"긍정": 0.0, "부정": 25.0, "중립": 75.0}, "대원": {"긍정": 0.0, "부정": 12.5, "중립": 87.5}, "인텍": {"긍정": 0.0, "부정": 25.0, "중립": 75.0}, "코잇": {"긍정": 0.0, "부정": 50.0, "중립": 50.0}}, "overall_sentiment": {"긍정": 8.7, "부정": 17.39, "중립": 73.91}, "total_product_service_counts": {"피씨디렉트": {"서비스": 4, "제품": 1}, "제이씨현": {"서비스": 2, "제품": 2}, "대원": {"서비스": 6, "제품": 2}, "인텍": {"서비스": 4, "제품": 0}, "코잇": {"서비스": 2, "제품": 0}}, "product_sentiment": {"피씨디렉트": {"긍정": 0, "부정": 0, "중립": 1}, "제이씨현": {"긍정": 0, "부정": 0, "중립": 2}, "대원": {"긍정": 0, "부정": 0, "중립": 2}}, "service_sentiment": {"피씨디렉트": {"긍정": 2, "부정": 0, "중립": 2}, "제이씨현": {"긍정": 0, "부정": 1, "중립": 1}, "대원": {"긍정": 0, "부정": 1, "중립": 5}, "인텍": {"긍정": 0, "부정": 1, "중립": 3}, "코잇": {"긍정": 0, "부정": 1, "중립": 1}}, "weekly_sentiment": [{"week": "2025-10-13/2025-10-19", "brand": "대원", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-10-13/2025-10-19", "brand": "피씨디렉트", "긍정": 1, "부정": 0, "중립": 0}, {"week": "2025-10-20/2025-10-26", "brand": "대원", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-10-20/2025-10-26", "brand": "인텍", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-10-20/2025-10-26", "brand": "제이씨현", "긍정": 0, "부정": 0, "중립": 2}, {"week": "2025-10-20/2025-10-26", "brand": "피씨디렉트", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-10-27/2025-11-02", "brand": "대원", "긍정": 0, "부정": 1, "중립": 4}, {"week": "2025-10-27/2025-11-02", "brand": "인텍", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-10-27/2025-11-02", "brand": "제이씨현", "긍정": 0, "부정": 1, "중립": 1}, {"week": "2025-10-27/2025-11-02", "brand": "코잇", "긍정": 0, "부정": 1, "중립": 1}, {"week": "2025-10-27/2025-11-02", "brand": "피씨디렉트", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-11-03/2025-11-09", "brand": "대원", "긍정": 0, "부정": 0, "중립": 1}, {"week": "2025-11-03/2025-11-09", "brand": "인텍", "긍정": 0, "부정": 1, "중립": 1}, {"week": "2025-11-03/2025-11-09", "brand": "피씨디렉트", "긍정": 1, "부정": 0, "중립": 1}], "brand_order": ["피씨디렉트", "제이씨현", "대원", "인텍", "코잇"], "sentiment_order": ["긍정", "부정", "중립"], "recent_posts": {"대원": [{"작성일자": "2025-11-04", "제목": "대원 인텍 stcom 중에 as는 어디가 젤낫나여?", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49492091"}, {"작성일자": "2025-11-01", "제목": "보드AS 는 대원 과 ST 중 어떤게 나을까요", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49455717"}, {"작성일자": "2025-10-31", "제목": "만리 5080 스텔라 리퍼글카 상태 (대원 재문의 결과 추가)", "분석": "부정", "링크": "https://quasarzone.com/recent/views/all/49446271"}, {"작성일자": "2025-10-30", "제목": "Rx 9070 REAPER 대원씨티에스 네이버페이 후기이벤트 참여", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49438897"}, {"작성일자": "2025-10-29", "제목": "만리 5080 스텔라 대원 택배AS 결과..", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49423465"}], "인텍": [{"작성일자": "2025-11-04", "제목": "대원 인텍 stcom 중에 as는 어디가 젤낫나여?", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49492091"}, {"작성일자": "2025-11-04", "제목": "인텍앤컴퍼니 Asus 그래픽카드 방문수리 후기", "분석": "부정", "링크": "https://quasarzone.com/recent/views/all/49492130"}, {"작성일자": "2025-10-29", "제목": "5090 아스트랄 인텍 AS 후기", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49424131"}, {"작성일자": "2025-10-20", "제목": "대원 vs 인텍", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49317493"}], "제이씨현": [{"작성일자": "2025-10-30", "제목": "PALIT 지포스 RTX 5070 INFINITY 3 D7 12GB 이엠텍 vs PNY 지포스 RTX 5070 D7 12GB Triple Fan", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49433918"}, {"작성일자": "2025-10-29", "제목": "진짜 개똥같은 제이씨현 CS이노베이션...", "분석": "부정", "링크": "https://quasarzone.com/recent/views/all/49421862"}, {"작성일자": "2025-10-26", "제목": "[사용/오픈기] GIGABYTE X870E AORUS MASTER X3D ICE 제이씨현", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49387523"}, {"작성일자": "2025-10-25", "제목": "고장난 5090어마 수리 비용(제이씨현)", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49380393"}], "코잇": [{"작성일자": "2025-10-31", "제목": "코잇 메인보드AS 점검 이후 배송받았더니 pcie슬롯 파손 건", "분석": "부정", "링크": "https://quasarzone.com/recent/views/all/49450819"}, {"작성일자": "2025-10-30", "제목": "265k 메인보드 코잇 AS 이후 파손 문제", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49439808"}], "피씨디렉트": [{"작성일자": "2025-11-06", "제목": "피씨디렉티 메인보드 AS관련 질문", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49512062"}, {"작성일자": "2025-11-04", "제목": "5080 불칸 ( 피씨디렉트 ) 교환 후기", "분석": "긍정", "링크": "https://quasarzone.com/recent/views/all/49485256"}, {"작성일자": "2025-10-30", "제목": "B650m AORUS ELITE 피씨디렉트", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49435351"}, {"작성일자": "2025-10-24", "제목": "피씨디렉트 고주파 초기불량기간 지나면 새제품으로 교환이 안되나요?…", "분석": "중립", "링크": "https://quasarzone.com/recent/views/all/49368914"}, {"작성일자": "2025-10-15", "제목": "피씨디렉트 as 좋네요.", "분석": "긍정", "링크": "https://quasarzone.com/recent/views/all/49266333"}]}};

        // 새로운 색상 팔레트
        const colors = {
            positive: '#67CA43',
            negative: '#F57D6E',
            neutral: '#CAC4BC',
            bar: '#d4d4d4'
        };

        // 데이터 시각화 함수
        function createBarChart(canvasId, labels, data) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '게시글 수',
                        data: data,
                        backgroundColor: colors.bar,
                        borderRadius: 5,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 0.5, // 그래프 높이를 2배로 설정 (1:1 -> 1:2)
                    scales: {
                        y: { beginAtZero: true, grid: { display: false } },
                        x: { grid: { display: false } }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function createStackedBarChart(canvasId, labels, datasets, stacked) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: { labels: labels, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 0.5, // 그래프 높이를 2배로 설정
                    scales: {
                        x: { stacked: stacked, grid: { display: false } },
                        y: { stacked: stacked, beginAtZero: true, grid: { display: false } }
                    }
                }
            });
        }
        
        function createSentimentStackedBarChart(canvasId, labels, data) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const datasets = reportData.sentiment_order.map(sentiment => {
                let color;
                if (sentiment === '긍정') color = colors.positive;
                else if (sentiment === '부정') color = colors.negative;
                else color = colors.neutral;

                return {
                    label: sentiment,
                    data: labels.map(label => data[label]?.[sentiment] || 0),
                    backgroundColor: color
                };
            });

            new Chart(ctx, {
                type: 'bar',
                data: { labels: labels, datasets: datasets },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 0.5, // 그래프 높이를 2배로 설정
                    scales: {
                        x: { stacked: true, grid: { display: false } },
                        y: { stacked: true, beginAtZero: true, grid: { display: false } }
                    }
                }
            });
        }

        function createPieChart(canvasId, data) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: reportData.sentiment_order,
                    datasets: [{
                        data: reportData.sentiment_order.map(s => data[s]),
                        backgroundColor: [colors.positive, colors.negative, colors.neutral],
                        borderColor: '#fff',
                        hoverOffset: 4
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        }

        // 1. 전반적인 평판 현황
        createBarChart('brandCountsChart', Object.keys(reportData.brand_counts), Object.values(reportData.brand_counts));

        const brandCountsTableBody = document.getElementById('brandCountsTableBody');
        reportData.brand_order.forEach(brand => {
            const row = brandCountsTableBody.insertRow();
            row.insertCell(0).innerText = brand;
            const productCount = reportData.total_product_service_counts[brand]?.['제품'] || 0;
            const serviceCount = reportData.total_product_service_counts[brand]?.['서비스'] || 0;
            row.insertCell(1).innerText = productCount + serviceCount;
            row.insertCell(2).innerText = productCount;
            row.insertCell(3).innerText = serviceCount;
        });

        createPieChart('overallSentimentChart', reportData.overall_sentiment);
        
        const sentimentTableBody = document.getElementById('sentimentTableBody');
        const overallRow = sentimentTableBody.insertRow();
        overallRow.insertCell(0).innerText = '전체';
        reportData.sentiment_order.forEach((sentiment, i) => {
            const cell = overallRow.insertCell(i+1);
            cell.innerText = reportData.overall_sentiment[sentiment] || 0;
            if (sentiment === '긍정') {
                cell.classList.add('text-positive');
            } else if (sentiment === '부정') {
                cell.classList.add('text-negative');
            }
        });

        reportData.brand_order.forEach(brand => {
            const row = sentimentTableBody.insertRow();
            row.insertCell(0).innerText = brand;
            reportData.sentiment_order.forEach((sentiment, i) => {
                const cell = row.insertCell(i+1);
                cell.innerText = reportData.brand_sentiment_ratios[brand]?.[sentiment] || 0;
                if (sentiment === '긍정') {
                    cell.classList.add('text-positive');
                } else if (sentiment === '부정') {
                    cell.classList.add('text-negative');
                }
            });
        });
        
        // 2. 부문별 평판 분석
        const sectorLabels = reportData.brand_order;
        
        createSentimentStackedBarChart('productSentimentChart', sectorLabels, reportData.product_sentiment);
        const productTableBody = document.getElementById('productTableBody');
        sectorLabels.forEach(brand => {
            const row = productTableBody.insertRow();
            row.insertCell(0).innerText = brand;
            reportData.sentiment_order.forEach((sentiment, i) => {
                const cell = row.insertCell(i+1);
                cell.innerText = reportData.product_sentiment[brand]?.[sentiment] || 0;
                if (sentiment === '긍정') {
                    cell.classList.add('text-positive');
                } else if (sentiment === '부정') {
                    cell.classList.add('text-negative');
                }
            });
        });

        createSentimentStackedBarChart('serviceSentimentChart', sectorLabels, reportData.service_sentiment);
        const serviceTableBody = document.getElementById('serviceTableBody');
        sectorLabels.forEach(brand => {
            const row = serviceTableBody.insertRow();
            row.insertCell(0).innerText = brand;
            reportData.sentiment_order.forEach((sentiment, i) => {
                const cell = row.insertCell(i+1);
                cell.innerText = reportData.service_sentiment[brand]?.[sentiment] || 0;
                if (sentiment === '긍정') {
                    cell.classList.add('text-positive');
                } else if (sentiment === '부정') {
                    cell.classList.add('text-negative');
                }
            });
        });

        // 3. 시간별 평판 추이
        const weeklyLabels = [...new Set(reportData.weekly_sentiment.map(item => item.week))].sort();
        
        const weeklyDatasets = reportData.sentiment_order.map(sentiment => {
            let color;
            if (sentiment === '긍정') color = colors.positive;
            else if (sentiment === '부정') color = colors.negative;
            else color = colors.neutral;

            return {
                label: sentiment,
                data: weeklyLabels.map(week => reportData.weekly_sentiment.filter(item => item.week === week).reduce((sum, item) => sum + (item[sentiment] || 0), 0)),
                backgroundColor: color
            };
        });
        createStackedBarChart('weeklySentimentChart', weeklyLabels, weeklyDatasets, true);
        
        const weeklyTableBody = document.getElementById('weeklyTableBody');
        weeklyLabels.forEach(week => {
            const row = weeklyTableBody.insertRow();
            row.insertCell(0).innerText = week;
            reportData.brand_order.forEach(brand => {
                const data = reportData.weekly_sentiment.find(item => item.week === week && item.brand === brand) || {};
                reportData.sentiment_order.forEach((sentiment, i) => {
                    const cell = row.insertCell(reportData.brand_order.indexOf(brand) * 3 + (i + 1));
                    cell.innerText = data[sentiment] || 0;
                    if (sentiment === '긍정') {
                        cell.classList.add('text-positive');
                    } else if (sentiment === '부정') {
                        cell.classList.add('text-negative');
                    }
                });
            });
        });
        
        
        // 4. 브랜드별 최근 5건 게시글
        const recentWrap = document.getElementById('recentPostsSection');

        function makeBrandTable(brand, rows) {
            const wrapper = document.createElement('div');
            wrapper.className = 'table-box';

            const title = document.createElement('h3');
            title.textContent = brand;
            wrapper.appendChild(title);

            const table = document.createElement('table');
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>작성일자</th><th>제목</th><th>분석</th><th>링크</th>
                    </tr>
                </thead>
                <tbody></tbody>`;
            const tbody = table.querySelector('tbody');

            (rows || []).forEach(r => {
            const tr = document.createElement('tr');

            const tdDate = document.createElement('td');
            tdDate.textContent = r['작성일자'] || '';

            const tdTitle = document.createElement('td');
            tdTitle.style.textAlign = 'left';
            tdTitle.textContent = r['제목'] || '';

            const tdAnal = document.createElement('td');
            const sentiment = (r['분석'] || '').trim();
            tdAnal.textContent = sentiment;
            if (sentiment === '긍정') tdAnal.classList.add('text-positive');
            else if (sentiment === '부정') tdAnal.classList.add('text-negative');
            // 중립은 색상 없음 (필요하면 .text-neutral 추가해서 쓰면 됩니다)

            const tdLink = document.createElement('td');
            if (r['링크']) {
                const a = document.createElement('a');
                a.href = r['링크'];
                a.target = '_blank';
                a.textContent = '바로가기';
                tdLink.appendChild(a);
            }

            tr.appendChild(tdDate);
            tr.appendChild(tdTitle);
            tr.appendChild(tdAnal);
            tr.appendChild(tdLink);
            tbody.appendChild(tr);
        });

            wrapper.appendChild(table);
            return wrapper;
        }

        // 브랜드 순서대로 표 생성
        (reportData.brand_order || []).forEach(brand => {
            const rows = (reportData.recent_posts && reportData.recent_posts[brand]) ? reportData.recent_posts[brand] : [];
            if (rows.length > 0) {
                recentWrap.appendChild(makeBrandTable(brand, rows));
            }
        });
        
        
    </script>
</body>
</html>
